{% extends "base.html" %}
{% load babel %}
{% load bolibana %}

{% block title %}Rapport non validé{% endblock %}
{% block pagetitle %}<h1 class="pagetitle">Système d'information de routine sur le Paludisme</h1>{% endblock %}
{% block submenu %}{% include "submenutrans.html" %}{% endblock %}

{% block content %}
<script type="text/javascript">
function toggleme(slug) {
	$('.sms_' + slug).toggle();
}
</script>

<div id="context">

	<h2>Rapports non validés</h2>

	<table>
	<caption>Aperçu de l'état d'avancement de la validation des Rapports.</caption>
	<tr><th>District/CSCOM</th><th>Taux de validation</th><th>Validés / Total de rapports</th></tr>
		{% for district in entities %}
	<tr><th>{{ district.entity }}</th><td class="center"><strong>{{ district.validation_rate|percent:2 }}</strong></td><td>{{ district.nb_valideted}}/{{ district.nb_expected}}</td></td></tr>
	{% if district.children %}
		{% for center in district.children %}
		<tr><td>{{ center }}</th><td colspan="2" class="center" onclick="javascript:toggleme('{{center.entity.slug}}');">{% if center.sms|length %}<strong>{{ center.sms|length }} SMS</strong>{% else %}-{% endif %}</td></tr>
		{% for sms in center.sms %}
		<tr style="display: none;" class="sms_{{ center.entity.slug }}"><td colspan="3">{{ sms.date }} : {{ sms.text }}</td></tr>{% endfor %}
		{% endfor %}
	{% endif %}

	{% endfor %}
	{% for report in reports %}
	<tr><th>{{ report }}</th><td class="center"><strong>{{ report.mperiod }}</strong>
	</td><td>{{ report.entity}}</td><td>{{ report.receipt}}</td></tr>

	{% endfor %}
	</table>
	</div>

{% endblock %}
